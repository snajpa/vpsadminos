# Generated by osctld
<% OsCtld::Lxc::dist_lxc_configs(distribution, version).each do |cfg| -%>
lxc.include = <%= cfg %>
<% end -%>
lxc.include = /etc/lxc/common.conf.d/00-lxcfs.conf
<% if ct.nesting -%>
lxc.include = <%= File.join(Lxc::CONFIGS, 'nesting.conf') %>
<% end -%>

lxc.rootfs.path = <%= ct.rootfs %>
lxc.arch = <%= ct.arch %>
lxc.uts.name = <%= ct.hostname || ct.id %>

lxc.namespace.clone=user mnt pid uts net ipc cgroup syslog

<% ct.user.uid_map.each do |entry| -%>
lxc.idmap = u <%= entry.ns_id %> <%= entry.host_id %> <%= entry.count %>
<% end -%>
<% ct.user.gid_map.each do |entry| -%>
lxc.idmap = g <%= entry.ns_id %> <%= entry.host_id %> <%= entry.count %>
<% end -%>

lxc.seccomp.profile = <%= ct.seccomp_profile %>
lxc.apparmor.profile = <%= ct.apparmor.namespace_profile_name %>
lxc.autodev = 1

lxc.hook.version = 1
lxc.hook.pre-start = <%= OsCtld::hook_run('ct-pre-start', ct.pool) %>
lxc.hook.pre-mount = <%= OsCtld::hook_run('ct-pre-mount', ct.pool) %>
lxc.hook.mount = <%= OsCtld::hook_run('ct-post-mount', ct.pool) %>
lxc.hook.autodev = <%= OsCtld::hook_run('ct-autodev', ct.pool) %>
lxc.hook.start-host = <%= OsCtld::hook_run('ct-on-start', ct.pool) %>
lxc.hook.post-stop = <%= OsCtld::hook_run('ct-post-stop', ct.pool) %>

lxc.include = <%= config_path('network') %>
lxc.include = <%= config_path('cgparams') %>
lxc.include = <%= config_path('prlimits') %>
lxc.include = <%= config_path('mounts') %>
